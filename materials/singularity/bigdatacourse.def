BootStrap: docker
From: ubuntu:22.04

%runscript
    echo "This is what happens when you run the container..."



%files
    findPeaks.r usr/bin/
    group.r usr/bin/
    readOpenMS.r usr/bin/
    xcmsCollect.r usr/bin/
    retCor.r usr/bin/

%post
    # Updating repo
    apt-get update -y

    # Trial and error commands
    # echo "LC_ALL=en_US.UTF-8" >> /etc/environment
    # echo "en_US.UTF-8 UTF-8" >> /etc/locale.gen
    # echo "LANG=en_US.UTF-8" > /etc/locale.conf
    # apt-get install locales
    # locale-gen en_US.UTF-8
    # export DEBIAN_FRONTEND=noninteractive # keeps the env to noninterative, hence removing any input needed during the build


    # Setting timezome, necessary for some codes
    ln -snf /usr/share/zoneinfo/$CONTAINER_TIMEZONE /etc/localtime && echo $CONTAINER_TIMEZONE > /etc/timezone


    # Downloading and installing OpenMS
    apt install wget -y
    dpkg --add-architecture i386 && apt-get update -y && apt-get install dialog
    wget -O /media/OpenMS-2.4.0-Debian-Linux-x86_64.deb https://abibuilder.cs.uni-tuebingen.de/archive/openms/OpenMSInstaller/release/2.4.0/OpenMS-2.4.0-Debian-Linux-x86_64.deb
    apt-get install build-essential  libgl1-mesa-dev -y && apt-get install qtbase5-dev:i386 -y && apt-get install qtbase5-dev -y && dpkg -i /media/OpenMS-2.4.0-Debian-Linux-x86_64.deb


    # Installing R and necessary packages
    apt install r-base r-base-dev -y
    apt-get install libnetcdf-dev -y
    apt-get install libxml2 -y
    apt-get install libxml2-dev -y


    # Installing R packages
    Rscript -e 'install.packages(c("XML", "xml2"))'
    Rscript -e 'install.packages("BiocManager")'
    Rscript -e 'BiocManager::install("MSnbase")'
    Rscript -e 'BiocManager::install("xcms",force = TRUE)'

